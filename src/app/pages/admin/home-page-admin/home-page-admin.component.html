<div class="app-container">
  <app-nav-bar-admin class="vertical-navbar"></app-nav-bar-admin>

  <div class="content">
    <div class="container-xl">
      <div class="table-responsive">
        <div class="table-wrapper">
          <div class="table-title">
            <div class="row align-items-center">
              <div class="col-sm-6">
                <h2>Administrador de <b>Supervisores</b></h2>
              </div>
              <div class="col-sm-6 col-md-3 mt-3 mt-md-0">
                <div class="input-group">
                  <input type="text" class="form-control" placeholder="Buscar" [(ngModel)]="searchText" (input)="applyFilter()">
                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary search-btn" type="button" (click)="clearSearch()">
                      <i class="fa" [ngClass]="{'fa-times': searchText, 'fa-trash': !searchText}"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-md-3 mt-3 mt-md-0">
                <button class="btn btn-success" data-toggle="modal" data-target="#addSupervisorModal">
                  <i class="material-icons">&#xE147;</i>
                  <span>Agregar Nuevo Supervisor</span>
                </button>
              </div>
            </div>
          </div>
          <table class="table table-hover">
            <thead>
              <tr>
                <th>
                  <span class="custom-checkbox">
                    <input type="checkbox" id="checkAll" (change)="selectAll($event)">
                    <label for="checkAll"></label>
                  </span>
                </th>
                <th>Nombre</th>
                <th>Apellido</th>
                <th>Correo Electrónico</th>
                <th>Contraseña</th>
                <th>DNI</th>
                <th>Número Telefónico</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let supervisor of getPaginatedSupervisores()">
                <td>
                  <span class="custom-checkbox">
                    <input type="checkbox" [id]="'checkbox' + supervisor.id" name="options[]" [value]="supervisor.id"
                      [checked]="supervisor.isSelected" (change)="selectCheckbox($event, supervisor)">
                    <label [for]="'checkbox' + supervisor.id"></label>
                  </span>
                </td>
                <td>{{ supervisor.nombre }}</td>
                <td>{{ supervisor.apellido }}</td>
                <td>{{ supervisor.correoElectronico }}</td>
                <td>{{ supervisor.contrasena }}</td>
                <td>{{ supervisor.dni }}</td>
                <td>{{ supervisor.numeroTelefonico }}</td>
                <td>
                  <a href="#" class="edit" (click)="editSupervisor(supervisor)" data-toggle="modal"
                    [attr.data-target]="supervisor.isSelected ? '#editSupervisorModal' : null"
                    [ngClass]="{ 'disabled': !supervisor.isSelected }">
                    <i class="material-icons" data-toggle="tooltip" title="Editar">&#xE254;</i>
                  </a>
                  <a href="#" class="delete" (click)="selectedSupervisorId = supervisor.id" data-toggle="modal"
                    [attr.data-target]="supervisor.isSelected ? '#deleteSupervisorModal' : null"
                    [ngClass]="{ 'disabled': !supervisor.isSelected }">
                    <i class="material-icons" data-toggle="tooltip" title="Eliminar">&#xE872;</i>
                  </a>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="clearfix">
            <div class="hint-text">Mostrando <b>{{ getPaginatedSupervisores().length }}</b> de <b>{{ totalSupervisores
                }}</b> registros</div>
            <ul class="pagination">
              <li class="page-item" [class.disabled]="currentPage === 1">
                <button class="page-link" (click)="setPage(currentPage - 1)">Anterior</button>
              </li>
              <li class="page-item" *ngFor="let page of getPageNumbers()" [class.active]="currentPage === page">
                <button class="page-link" (click)="setPage(page)">{{ page }}</button>
              </li>
              <li class="page-item" [class.disabled]="currentPage === totalPages">
                <button class="page-link" (click)="setPage(currentPage + 1)">Siguiente</button>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Add Modal HTML -->
<div id="addSupervisorModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="addSupervisorModalLabel"
  aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Agregar Supervisor</h4>
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="addNombre">Nombre</label>
          <input type="text" class="form-control" id="addNombre" [(ngModel)]="newSupervisor.nombre" name="addNombre"
            required>
        </div>
        <div class="form-group">
          <label for="addApellido">Apellido</label>
          <input type="text" class="form-control" id="addApellido" [(ngModel)]="newSupervisor.apellido"
            name="addApellido" required>
        </div>
        <div class="form-group">
          <label for="addCorreoElectronico">Correo Electrónico</label>
          <input type="email" class="form-control" id="addCorreoElectronico"
            [(ngModel)]="newSupervisor.correoElectronico" name="addCorreoElectronico" required>
        </div>
        <div class="form-group">
          <label for="addContrasena">Contraseña</label>
          <input type="text" class="form-control" id="addContrasena" [(ngModel)]="newSupervisor.contrasena"
            name="addContrasena" required>
        </div>
        <div class="form-group">
          <label for="addDNI">DNI</label>
          <input type="number" class="form-control" id="addDNI" [(ngModel)]="newSupervisor.dni" name="addDNI"
            required>
          <small class="text-muted">El DNI debe tener exactamente 8 dígitos numéricos.</small>
        </div>
        <div class="form-group">
          <label for="addNumeroTelefonico">Número Telefónico</label>
          <input type="number" class="form-control" id="addNumeroTelefonico"
            [(ngModel)]="newSupervisor.numeroTelefonico" name="addNumeroTelefonico" required>
          <small class="text-muted">El número telefónico exactamente 9 dígitos numéricos</small>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
        <button class="btn btn-success" [disabled]="!isNewSupervisorValid()" (click)="agregarSupervisor()"
          data-dismiss="modal">Agregar</button>
      </div>
    </div>
  </div>
</div>

<!-- Edit Modal HTML -->
<div id="editSupervisorModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="editSupervisorModalLabel"
  aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" *ngIf="selectedSupervisor">
      <form>
        <div class="modal-header">
          <h4 class="modal-title">Editar Supervisor</h4>
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="editNombre">Nombre</label>
            <input type="text" class="form-control" id="editNombre" [(ngModel)]="selectedSupervisor.nombre"
              name="editNombre" required>
          </div>
          <div class="form-group">
            <label for="editApellido">Apellido</label>
            <input type="text" class="form-control" id="editApellido" [(ngModel)]="selectedSupervisor.apellido"
              name="editApellido" required>
          </div>
          <div class="form-group">
            <label for="editCorreoElectronico">Correo Electrónico</label>
            <input type="email" class="form-control" id="editCorreoElectronico"
              [(ngModel)]="selectedSupervisor.correoElectronico" name="editCorreoElectronico" required>
          </div>
          <div class="form-group">
            <label for="editContrasena">Contraseña</label>
            <input type="text" class="form-control" id="editContrasena" [(ngModel)]="selectedSupervisor.contrasena"
              name="editContrasena" required>
          </div>
          <div class="form-group">
            <label for="editDNI">DNI</label>
            <input type="text" class="form-control" id="editDNI" [(ngModel)]="selectedSupervisor.dni" name="editDNI"
              required>
          </div>
          <div class="form-group">
            <label for="editNumeroTelefonico">Número Telefónico</label>
            <input type="text" class="form-control" id="editNumeroTelefonico"
              [(ngModel)]="selectedSupervisor.numeroTelefonico" name="editNumeroTelefonico" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
          <button class="btn btn-info" (click)="saveEditedSupervisor()" data-dismiss="modal">Guardar</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Delete Modal HTML -->
<div id="deleteSupervisorModal" class="modal fade" tabindex="-1" role="dialog"
  aria-labelledby="deleteSupervisorModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form>
        <div class="modal-header">
          <h4 class="modal-title">Eliminar Supervisor</h4>
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        </div>
        <div class="modal-body">
          <p>¿Estás seguro de que deseas eliminar este registro?</p>
          <p class="text-warning"><small>Esta acción no se puede deshacer.</small></p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
          <button class="btn btn-danger" (click)="deleteSupervisor()" data-dismiss="modal">Eliminar</button>
        </div>
      </form>
    </div>
  </div>
</div>